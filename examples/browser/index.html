<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>torch.js browser backprop example</title>

  <!-- torch UMD bundle exposes global `torch` -->
  <script src="../../vendor/gpu-browser.min.js"></script>
  <script src="../../build/browser/torch.browser.umd.js"></script>
</head>

<body>
  <pre id="output"></pre>

  <script>
    console.log("Is GPU supported:", GPU.isGPUSupported);
    console.log("Is kernel map supported:", GPU.isKernelMapSupported);
    console.log("Is off-screen canvas supported:", GPU.isOffscreenCanvasSupported);
    console.log("Is WebGL supported:", GPU.isWebGLSupported);
    console.log("Is WebGL2 supported:", GPU.isWebGL2Supported);
    console.log("Is HeadlessGL supported:", GPU.isHeadlessGLSupported);
    console.log("Is Canvas supported:", GPU.isCanvasSupported);
    console.log("Is GPUHTMLImageArray supported:", GPU.isGPUHTMLImageArraySupported);
    console.log("Is SinglePrecision supported:", GPU.isSinglePrecisionSupported);
  </script>
  <script>
    const { Tensor } = window.torch;

    const x = new Tensor([2.0], { requires_grad: true });
    const y = x.pow(new Tensor([2.0]));

    const outEl = document.getElementById('output');
    const log = (...args) => {
      console.log(...args);
      outEl.textContent += args.map(String).join(' ') + "\n";
    };

    log(y.item());
    y.backward();
    log(x.grad && x.grad.item());
  </script>
</body>

</html>